id: scw:spring:xml:xxe-protected-sources
version: 9
metadata:
  name: 'Input Validation: Avoid XXE: Use automatically protected source types'
  shortDescription: Could lead to XXE
  level: error
  language: java
  newCodeOnly: false
  scwCategory: injection:xml
  cweCategory: 611
  enabled: true
  tags: Spring;security;XXE;framework specific;Spring XML
  comment: Fixed in 2014 versions of Spring (4.0.1). To be checked if this covers all cases.
search:
  methodcall:
    args:
      1:
        type:
          reference:
            matches: javax.xml.transform.dom.DOMSource|javax.xml.transform.stax.StAXSource
          checkInheritance: false
    name: unmarshal
    declaration:
      type:
        reference:
          matches: org.springframework.oxm.Unmarshaller|org.springframework.oxm.jaxb.Jaxb2Marshaller
        checkInheritance: false
availableFixes: []
