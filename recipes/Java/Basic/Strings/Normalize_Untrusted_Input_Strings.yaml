id: scw:java:strings:normalize-untrusted
version: 8
metadata:
  name: Normalize Untrusted Input Strings
  shortDescription: Normalize untrusted inputs before using them
  level: info
  language: java
  cweCategory: 20
  enabled: false
  comment: In case of custom normalization, add your normalization method to the trustedSources
    section of the recipe.
  descriptionFile: Strings/descriptions/Normalize_Untrusted_Input_Strings.html
  tags: security;java-basic;SEI-CERT-IDS01-J
search:
  argument:
    containsUntrustedInput: true
    not:
      in:
        methodcall:
          name: normalize
          type: Normalizer
    trustedSources:
    - methodcall:
        name: normalize
        type: Normalizer
    type: java.lang.String
availableFixes:
- name: Insert normalize call
  actions:
  - rewrite:
      to: java.text.Normalizer.normalize({{markedElement}}, java.text.Normalizer.Form.NFKC)
