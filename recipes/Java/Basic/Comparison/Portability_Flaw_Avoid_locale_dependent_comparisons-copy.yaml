id: scw:java:case-conversion-after-equals
version: 8
metadata:
  name: 'Portability Flaw: Avoid locale dependent comparisons: case conversion after
    equals'
  shortDescription: This comparison is sensitive to the system's locale. Ignore the
    case or add a locale.
  level: error
  language: java
  newCodeOnly: false
  cweCategory: 474
  enabled: false
  comment: Cannot search for methodcall in argument of other methodcall?
  tags: security;java-basic;quality
search:
  methodcall:
    args:
      1: {}
    name: equals
    type: java.lang.String
availableFixes:
- name: Use equalsIgnoreCase
  actions:
  - rewrite:
      to: '{{{ qualifier.qualifier }}}.equalsIgnoreCase({{{ arguments.0 }}})'
      target: self
- name: Add ROOT locale
  actions:
  - rewrite:
      to: '{{{ qualifier.qualifier }}}.{{{ qualifier.methodName }}}(Locale.ROOT).{{{methodName
        }}}({{{ arguments.0 }}})'
      target: self
