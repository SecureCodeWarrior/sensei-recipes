id: scw:logging:printstacktrace
version: 9
metadata:
  name: 'Info Leakage: Throwable.printStacktrace leaks valuable program structure information'
  shortDescription: Printing a stack trace gives valuable information about software internals, including library/framework names and versions, to an attacker
  level: warning
  language: java
  scwCategory: infoexposure:debuginfo
  cweCategory: 200
  enabled: true
  comment: ""
  descriptionFile: descriptions/ThrowablePrintStacktraceLeaksInfo.html
  tags: security;logging
search:
  methodcall:
    name: printStackTrace
    declaration:
      type: java.lang.Throwable
availableFixes:
- name: Use SLF4J logger
  actions:
  - addField:
      field: private static final org.slf4j.Logger log = org.slf4j.LoggerFactory.getLogger({{type}}.class);
      target: parentClass
  - rewrite:
      to: log.info({{{ qualifier }}}.getMessage())
- name: Use Logger class
  actions:
  - addField:
      field: private static final java.util.logging.Logger logger = Logger.getLogger({{{ containingClass.name }}}.class.getName())
      target: parentClass
  - rewrite:
      to: logger.log(java.util.logging.Level.INFO, {{{ qualifier }}}.getMessage())
