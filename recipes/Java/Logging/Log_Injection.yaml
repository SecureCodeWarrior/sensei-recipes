id: scw:logging:log-untrusted-input
version: 9
metadata:
  name: Untrusted input in logging
  shortDescription: Prevent log injection by filtering untrusted input
  level: info
  language: java
  scwCategory: injection:generic
  cweCategory: 117
  enabled: true
  comment: ""
  descriptionFile: descriptions/Untrusted_input_in_logging.html
  tags: security;logging;injection;OWASP Top 10
search:
  argument:
    in:
      methodcall:
        name: log
        type: java.util.logging.Logger
    type: java.lang.String
    value:
      containsUntrustedInput: true
availableFixes:
- name: Filter newline characters
  actions:
  - rewrite:
      to: ({{{ markedElement }}}).replaceAll("(\\r|\\n)","")
- name: Mark source as trusted for this recipe
  actions: []
